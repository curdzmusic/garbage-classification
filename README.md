# Há»‡ thá»‘ng PhÃ¢n loáº¡i RÃ¡c tháº£i thÃ´ng minh â™»ï¸

**á»¨ng dá»¥ng web sá»­ dá»¥ng Deep Learning Ä‘á»ƒ phÃ¢n loáº¡i rÃ¡c tháº£i vÃ  cung cáº¥p thÃ´ng tin tÃ¡i cháº¿**

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![Framework: Streamlit](https://img.shields.io/badge/Framework-Streamlit-red.svg)](https://streamlit.io/)
[![Library: PyTorch](https://img.shields.io/badge/Library-PyTorch-orange.svg)](https://pytorch.org/)

Dá»± Ã¡n nÃ y lÃ  má»™t há»‡ thá»‘ng phÃ¢n loáº¡i rÃ¡c tháº£i tá»± Ä‘á»™ng sá»­ dá»¥ng mÃ´ hÃ¬nh Deep Learning (CNN) Ä‘á»ƒ nháº­n diá»‡n vÃ  phÃ¢n loáº¡i cÃ¡c loáº¡i rÃ¡c tháº£i tá»« hÃ¬nh áº£nh. Há»‡ thá»‘ng khÃ´ng chá»‰ phÃ¢n loáº¡i rÃ¡c mÃ  cÃ²n cung cáº¥p thÃ´ng tin há»¯u Ã­ch vá» kháº£ nÄƒng tÃ¡i cháº¿ cá»§a tá»«ng loáº¡i, giÃºp ngÆ°á»i dÃ¹ng cÃ³ Ã½ thá»©c hÆ¡n vá» viá»‡c phÃ¢n loáº¡i vÃ  xá»­ lÃ½ rÃ¡c tháº£i Ä‘Ãºng cÃ¡ch.

## âœ¨ TÃ­nh NÄƒng Ná»•i Báº­t

- ğŸ–¼ï¸ **PhÃ¢n loáº¡i rÃ¡c tá»« hÃ¬nh áº£nh**: Sá»­ dá»¥ng mÃ´ hÃ¬nh CNN tÃ¹y chá»‰nh Ä‘á»ƒ phÃ¢n loáº¡i 10 loáº¡i rÃ¡c tháº£i (battery, biological, cardboard, clothes, glass, metal, paper, plastic, shoes, trash).
- ğŸ“Š **Hiá»ƒn thá»‹ xÃ¡c suáº¥t dá»± Ä‘oÃ¡n**: Hiá»ƒn thá»‹ biá»ƒu Ä‘á»“ xÃ¡c suáº¥t cho táº¥t cáº£ cÃ¡c lá»›p vÃ  top-5 dá»± Ä‘oÃ¡n vá»›i Ä‘á»™ tin cáº­y cao nháº¥t.
- â™»ï¸ **ThÃ´ng tin tÃ¡i cháº¿**: Tá»± Ä‘á»™ng cung cáº¥p thÃ´ng tin vá» kháº£ nÄƒng tÃ¡i cháº¿ cá»§a tá»«ng loáº¡i rÃ¡c (TÃ¡i cháº¿ Ä‘Æ°á»£c / TÃ¡i cháº¿ Ä‘áº·c biá»‡t / KhÃ´ng tÃ¡i cháº¿).
- ğŸ“¸ **Nhiá»u nguá»“n Ä‘áº§u vÃ o**: Há»— trá»£ 3 cÃ¡ch nháº­p áº£nh:
  - Upload áº£nh tá»« thiáº¿t bá»‹
  - Nháº­p URL áº£nh tá»« internet
  - Chá»¥p áº£nh trá»±c tiáº¿p tá»« camera
- ğŸ¨ **Giao diá»‡n trá»±c quan**: Giao diá»‡n web Ä‘áº¹p máº¯t, dá»… sá»­ dá»¥ng vá»›i Streamlit, hiá»ƒn thá»‹ káº¿t quáº£ dá»± Ä‘oÃ¡n vÃ  biá»ƒu Ä‘á»“ má»™t cÃ¡ch trá»±c quan.
- ğŸš€ **Hiá»‡u suáº¥t cao**: Sá»­ dá»¥ng PyTorch vá»›i há»— trá»£ GPU Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ xá»­ lÃ½.

## ğŸ› ï¸ CÃ´ng Nghá»‡ Sá»­ Dá»¥ng

- **Backend & Machine Learning**:
  - **Python**: NgÃ´n ngá»¯ láº­p trÃ¬nh chÃ­nh.
  - **PyTorch**: Framework deep learning Ä‘á»ƒ xÃ¢y dá»±ng vÃ  triá»ƒn khai mÃ´ hÃ¬nh CNN.
  - **Torchvision**: ThÆ° viá»‡n há»— trá»£ xá»­ lÃ½ vÃ  transform hÃ¬nh áº£nh.
  - **Streamlit**: Framework web Ä‘á»ƒ xÃ¢y dá»±ng giao diá»‡n ngÆ°á»i dÃ¹ng nhanh chÃ³ng.
  - **PIL/Pillow**: Xá»­ lÃ½ vÃ  thao tÃ¡c vá»›i hÃ¬nh áº£nh.
  - **OpenCV**: Xá»­ lÃ½ hÃ¬nh áº£nh vÃ  video (náº¿u cáº§n).
  - **NumPy**: TÃ­nh toÃ¡n sá»‘ há»c vÃ  xá»­ lÃ½ máº£ng.
  - **Matplotlib**: Váº½ biá»ƒu Ä‘á»“ vÃ  hiá»ƒn thá»‹ dá»¯ liá»‡u.
  - **Plotly**: Táº¡o biá»ƒu Ä‘á»“ tÆ°Æ¡ng tÃ¡c.
  - **Pandas**: Xá»­ lÃ½ vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u.

- **Frontend**:
  - **Streamlit UI**: Giao diá»‡n ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c xÃ¢y dá»±ng hoÃ n toÃ n báº±ng Streamlit.

## ğŸš€ CÃ i Ä‘áº·t & Khá»Ÿi cháº¡y

### YÃªu cáº§u
- Python 3.10.x hoáº·c cao hÆ¡n
- Git (Ä‘á»ƒ clone repository)
- CUDA (tÃ¹y chá»n, Ä‘á»ƒ sá»­ dá»¥ng GPU náº¿u cÃ³)

### HÆ°á»›ng dáº«n cÃ i Ä‘áº·t

1. **Clone repository vá» mÃ¡y**
   ```bash
   git clone <your-repository-link>
   cd <repository-folder>
   ```

2. **Táº¡o vÃ  kÃ­ch hoáº¡t mÃ´i trÆ°á»ng áº£o (Virtual Environment)**
   
   ÄÃ¢y lÃ  bÆ°á»›c quan trá»ng Ä‘á»ƒ trÃ¡nh xung Ä‘á»™t thÆ° viá»‡n giá»¯a cÃ¡c dá»± Ã¡n.
   ```bash
   # Táº¡o mÃ´i trÆ°á»ng áº£o
   python -m venv venv
   
   # KÃ­ch hoáº¡t trÃªn Windows
   venv\Scripts\activate.bat
   
   # KÃ­ch hoáº¡t trÃªn macOS/Linux
   source venv/bin/activate
   ```

3. **CÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t**
   
   File `requirements.txt` chá»©a táº¥t cáº£ cÃ¡c thÆ° viá»‡n Python cáº§n thiáº¿t.
   ```bash
   pip install -r requirements.txt
   ```

### Cháº¡y chÆ°Æ¡ng trÃ¬nh

1. **Khá»Ÿi cháº¡y á»©ng dá»¥ng Streamlit**
   
   Cháº¡y file `app.py` Ä‘á»ƒ khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng web.
   ```bash
   streamlit run app.py
   ```
   
   *LÆ°u Ã½: Náº¿u báº¡n muá»‘n sá»­ dá»¥ng file `streamlit_garbage_classifier.py` thay tháº¿, cháº¡y:*
   ```bash
   streamlit run streamlit_garbage_classifier.py
   ```

2. **Truy cáº­p á»©ng dá»¥ng**
   
   á»¨ng dá»¥ng sáº½ tá»± Ä‘á»™ng má»Ÿ trong trÃ¬nh duyá»‡t web táº¡i Ä‘á»‹a chá»‰:
   [http://localhost:8501](http://localhost:8501)
   
   Náº¿u khÃ´ng tá»± Ä‘á»™ng má»Ÿ, báº¡n cÃ³ thá»ƒ truy cáº­p thá»§ cÃ´ng báº±ng cÃ¡ch má»Ÿ trÃ¬nh duyá»‡t vÃ  nháº­p Ä‘á»‹a chá»‰ trÃªn.

3. **Sá»­ dá»¥ng á»©ng dá»¥ng**
   - Chá»n má»™t trong 3 phÆ°Æ¡ng thá»©c nháº­p áº£nh: Upload, URL, hoáº·c Camera
   - Táº£i áº£nh lÃªn hoáº·c chá»¥p áº£nh
   - Xem káº¿t quáº£ phÃ¢n loáº¡i vÃ  thÃ´ng tin tÃ¡i cháº¿

## ğŸ“‚ Cáº¥u TrÃºc Dá»± Ãn

```
â”œâ”€â”€ README.md                          # File README
â”œâ”€â”€ app.py                             # File Streamlit chÃ­nh (á»©ng dá»¥ng chÃ­nh)
â”œâ”€â”€ streamlit_garbage_classifier.py    # File Streamlit thay tháº¿ (cÃ³ thÃªm tÃ­nh nÄƒng streaming)
â”œâ”€â”€ requirements.txt                   # Danh sÃ¡ch cÃ¡c thÆ° viá»‡n Python
â”œâ”€â”€ Garbage_Classification.ipynb       # Notebook Jupyter: Xá»­ lÃ½ dá»¯ liá»‡u vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh
â”œâ”€â”€ Garbage_Classification_Standalone.ipynb  # Notebook standalone (náº¿u cÃ³)
â”‚
â”œâ”€â”€ model/                             # ThÆ° má»¥c chá»©a mÃ´ hÃ¬nh
â”‚   â”œâ”€â”€ garbage_classifier_model.pth   # File mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n
â”‚   â”œâ”€â”€ garbage_classifier.py          # Äá»‹nh nghÄ©a kiáº¿n trÃºc mÃ´ hÃ¬nh CNN
â”‚   â””â”€â”€ model_load.py                  # Module táº£i mÃ´ hÃ¬nh
â”‚
â”œâ”€â”€ components/                        # CÃ¡c component Streamlit
â”‚   â”œâ”€â”€ upload.py                      # Module xá»­ lÃ½ Ä‘áº§u vÃ o (upload, URL, camera)
â”‚   â””â”€â”€ result_display.py              # Module hiá»ƒn thá»‹ káº¿t quáº£ vÃ  biá»ƒu Ä‘á»“
â”‚
â”œâ”€â”€ util/                              # CÃ¡c tiá»‡n Ã­ch vÃ  hÃ m há»— trá»£
â”‚   â”œâ”€â”€ inference.py                   # HÃ m suy luáº­n (prediction)
â”‚   â”œâ”€â”€ utilities.py                   # CÃ¡c hÃ m tiá»‡n Ã­ch (transform, load image, ...)
â”‚   â”œâ”€â”€ predict_analysis.py           # PhÃ¢n tÃ­ch vÃ  xá»­ lÃ½ káº¿t quáº£ dá»± Ä‘oÃ¡n
â”‚   â”œâ”€â”€ recycle_info.py                # ThÃ´ng tin vá» kháº£ nÄƒng tÃ¡i cháº¿
â”‚   â””â”€â”€ chart_render.py                # Render biá»ƒu Ä‘á»“
â”‚
â””â”€â”€ config/                            # ThÆ° má»¥c cáº¥u hÃ¬nh (náº¿u cÃ³)
```

## ğŸ“ HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

### Xá»­ lÃ½ dá»¯ liá»‡u vÃ  Huáº¥n luyá»‡n MÃ´ hÃ¬nh

1. **Má»Ÿ notebook Jupyter**:
   - Má»Ÿ file `Garbage_Classification.ipynb` trong Jupyter Notebook hoáº·c JupyterLab
   - Notebook nÃ y chá»©a toÃ n bá»™ quy trÃ¬nh:
     - Táº£i vÃ  xá»­ lÃ½ dá»¯ liá»‡u
     - XÃ¢y dá»±ng kiáº¿n trÃºc mÃ´ hÃ¬nh
     - Huáº¥n luyá»‡n mÃ´ hÃ¬nh
     - ÄÃ¡nh giÃ¡ vÃ  lÆ°u mÃ´ hÃ¬nh

2. **Cháº¡y tá»«ng Ã´ (cell)**:
   - Cháº¡y cÃ¡c Ã´ theo thá»© tá»± Ä‘á»ƒ thá»±c hiá»‡n tá»«ng bÆ°á»›c
   - Äáº£m báº£o báº¡n Ä‘Ã£ cÃ³ dá»¯ liá»‡u huáº¥n luyá»‡n trÆ°á»›c khi cháº¡y

3. **LÆ°u mÃ´ hÃ¬nh**:
   - Sau khi huáº¥n luyá»‡n xong, mÃ´ hÃ¬nh sáº½ Ä‘Æ°á»£c lÆ°u vÃ o `model/garbage_classifier_model.pth`
   - MÃ´ hÃ¬nh nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng trong á»©ng dá»¥ng web

### Triá»ƒn khai vÃ  Sá»­ dá»¥ng á»¨ng dá»¥ng Web

1. **Äáº£m báº£o mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n**:
   - File `model/garbage_classifier_model.pth` pháº£i tá»“n táº¡i
   - Náº¿u chÆ°a cÃ³, hÃ£y cháº¡y notebook `Garbage_Classification.ipynb` trÆ°á»›c

2. **Khá»Ÿi cháº¡y á»©ng dá»¥ng**:
   ```bash
   streamlit run app.py
   ```

3. **Sá»­ dá»¥ng giao diá»‡n**:
   - **Upload tá»« mÃ¡y**: Chá»n file áº£nh tá»« mÃ¡y tÃ­nh cá»§a báº¡n
   - **áº¢nh tá»« URL**: Nháº­p URL cá»§a áº£nh trÃªn internet
   - **Camera**: Chá»¥p áº£nh trá»±c tiáº¿p tá»« webcam

4. **Xem káº¿t quáº£**:
   - Káº¿t quáº£ phÃ¢n loáº¡i sáº½ hiá»ƒn thá»‹ ngay sau khi táº£i áº£nh
   - Xem biá»ƒu Ä‘á»“ xÃ¡c suáº¥t cho táº¥t cáº£ cÃ¡c lá»›p
   - Xem top-5 dá»± Ä‘oÃ¡n vá»›i Ä‘á»™ tin cáº­y
   - Äá»c thÃ´ng tin vá» kháº£ nÄƒng tÃ¡i cháº¿

## ğŸ¯ CÃ¡c Loáº¡i RÃ¡c Ä‘Æ°á»£c PhÃ¢n loáº¡i

Há»‡ thá»‘ng cÃ³ thá»ƒ phÃ¢n loáº¡i 10 loáº¡i rÃ¡c tháº£i sau:

1. **battery** - Pin (TÃ¡i cháº¿ Ä‘áº·c biá»‡t)
2. **biological** - RÃ¡c há»¯u cÆ¡ (KhÃ´ng tÃ¡i cháº¿)
3. **cardboard** - BÃ¬a carton (TÃ¡i cháº¿ Ä‘Æ°á»£c)
4. **clothes** - Quáº§n Ã¡o (KhÃ´ng tÃ¡i cháº¿)
5. **glass** - Thá»§y tinh (TÃ¡i cháº¿ Ä‘Æ°á»£c)
6. **metal** - Kim loáº¡i (TÃ¡i cháº¿ Ä‘Æ°á»£c)
7. **paper** - Giáº¥y (TÃ¡i cháº¿ Ä‘Æ°á»£c)
8. **plastic** - Nhá»±a (TÃ¡i cháº¿ Ä‘Æ°á»£c)
9. **shoes** - GiÃ y dÃ©p (KhÃ´ng tÃ¡i cháº¿)
10. **trash** - RÃ¡c há»—n há»£p (KhÃ´ng tÃ¡i cháº¿)

## ğŸ› Xá»­ lÃ½ sá»± cá»‘ (Troubleshooting)

- **Lá»—i `ModuleNotFoundError: No module named '...'`**:
  - Äáº£m báº£o báº¡n Ä‘Ã£ kÃ­ch hoáº¡t mÃ´i trÆ°á»ng áº£o (`venv`) trÆ°á»›c khi cháº¡y á»©ng dá»¥ng.
  - Cháº¡y láº¡i lá»‡nh `pip install -r requirements.txt` Ä‘á»ƒ cháº¯c cháº¯n ráº±ng táº¥t cáº£ thÆ° viá»‡n Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t.

- **Lá»—i `FileNotFoundError: model/garbage_classifier_model.pth`**:
  - Äáº£m báº£o báº¡n Ä‘Ã£ huáº¥n luyá»‡n mÃ´ hÃ¬nh báº±ng cÃ¡ch cháº¡y `Garbage_Classification.ipynb`.
  - Kiá»ƒm tra xem file mÃ´ hÃ¬nh cÃ³ tá»“n táº¡i trong thÆ° má»¥c `model/` khÃ´ng.

- **Camera khÃ´ng hoáº¡t Ä‘á»™ng**:
  - Kiá»ƒm tra xem camera Ä‘Ã£ Ä‘Æ°á»£c káº¿t ná»‘i Ä‘Ãºng cÃ¡ch vÃ  khÃ´ng bá»‹ á»©ng dá»¥ng nÃ o khÃ¡c sá»­ dá»¥ng.
  - Äáº£m báº£o báº¡n Ä‘Ã£ cáº¥p quyá»n cho trÃ¬nh duyá»‡t truy cáº­p camera.

- **á»¨ng dá»¥ng cháº¡y cháº­m**:
  - Náº¿u cÃ³ GPU, Ä‘áº£m báº£o PyTorch Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t vá»›i há»— trá»£ CUDA.
  - Kiá»ƒm tra xem GPU cÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng khÃ´ng báº±ng cÃ¡ch xem log khi khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng.

- **Lá»—i khi táº£i áº£nh tá»« URL**:
  - Kiá»ƒm tra káº¿t ná»‘i internet.
  - Äáº£m báº£o URL áº£nh há»£p lá»‡ vÃ  cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c.

## ğŸ“„ Giáº¥y PhÃ©p

Dá»± Ã¡n nÃ y Ä‘Æ°á»£c phÃ¢n phá»‘i dÆ°á»›i giáº¥y phÃ©p MIT. Xem tá»‡p `LICENSE` Ä‘á»ƒ biáº¿t thÃªm thÃ´ng tin.

## ğŸ‘¥ ÄÃ³ng GÃ³p

ChÃºng tÃ´i hoan nghÃªnh cÃ¡c Ä‘Ã³ng gÃ³p tá»« cá»™ng Ä‘á»“ng. Äá»ƒ Ä‘Ã³ng gÃ³p:

1. Fork dá»± Ã¡n.
2. Táº¡o nhÃ¡nh tÃ­nh nÄƒng má»›i (`git checkout -b feature/AmazingFeature`).
3. Commit cÃ¡c thay Ä‘á»•i cá»§a báº¡n (`git commit -m 'Add some AmazingFeature'`).
4. Push lÃªn nhÃ¡nh (`git push origin feature/AmazingFeature`).
5. Má»Ÿ má»™t Pull Request.

## ğŸ“§ LiÃªn Há»‡

Náº¿u báº¡n cÃ³ cÃ¢u há»i hoáº·c gÃ³p Ã½, vui lÃ²ng táº¡o má»™t issue trÃªn GitHub repository.

## ğŸ™ Lá»i Cáº£m Æ n

Cáº£m Æ¡n táº¥t cáº£ nhá»¯ng ngÆ°á»i Ä‘Ã£ Ä‘Ã³ng gÃ³p vÃ  há»— trá»£ cho dá»± Ã¡n nÃ y. Dá»± Ã¡n nÃ y Ä‘Æ°á»£c phÃ¡t triá»ƒn vá»›i má»¥c tiÃªu nÃ¢ng cao Ã½ thá»©c vá» phÃ¢n loáº¡i rÃ¡c tháº£i vÃ  báº£o vá»‡ mÃ´i trÆ°á»ng.

